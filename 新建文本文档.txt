node version_generator.js -v 1.14 -u http://192.168.0.103/tutorial-hot-update/remote-assets/ -s build/jsb-link/ -d gen/

D:\CocosCreator_2.2.1\resources\cocos2d-x\simulator\win32\blackjack-remote-asset

׼��������

1. CocosCreator

2. WebStorm || VSCode

3. ��װnode.js

4. ����protobufjs6.8.6

?

�����а�װ��

����1. ��װhomebrew

/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

?

����2. ��װnode.js npm ��npm ��ʵ����Node.js�İ���������(Node Package Manager)��

brew install node

���߹������ذ�װ �� https://nodejs.org/en/#download

?

����3. ��װprotobfujs��ȫ��

npm install -g protobufjs? ע�⣺�������ᰲװ���°汾

Ŀ���Ƿ���ʹ��protobufjs�ṩ��pbjs���ߡ�pbjs���Խ�protoԭ�ļ�ת����json��js�ȣ����ṩ��ͬ�ļ���proto��ʽ������pbts��������ת�����js�ļ�תΪts��

?

����4.�ҵ����ص�protobuf.js

path: /usr/local/lib/node_modules/protobufjs/dist

��protobuf.js�ϵ�creator�����в�����Ϊ���

?

����5.�ڱ���.proto�ļ���Ŀ¼�´�������ִ�����

pbjs -t static-module -w commonjs -o proto.js *.proto

���������ǽ��ļ������е� .proto �ļ�ת��Ϊһ�� proto.js �ļ�

?

����6. ��proto.js�ļ��������Ŀ¼��

?

����7. �޸� proto.js �ļ��е�����



��Ϊprotobuf�Ѿ�������Ϊ����ˡ�

?

����8. ���ʹ�� TS ��ʽ������ͨ�� protobufjs6 �¹�����ʵ��

pbts -o proto.d.ts proto.js

�����ɶ�Ӧ�� proto.d.ts�ļ���ע�⣺����proto.d.tsһ��Ҫ��.d

?

����ʹ�ã�

v6.x������

let req = HeartBeatReq.create({param1: 1, param2: 2});

let buffer = HeartBeatReq.encode(req).finish();

socket.send(buffer, MsgID);

?

ע�⣺������version 6.x�汾ʹ��protobufjs��ʵ��
?

5.x �汾�뿴�����ʹ�ò���
?

����3. ����protobufjs 5.x �汾

npm install -g protobufjs@5? ? ?ע�⣺version 6.x�汾�ӿڱ仯̫��ʹ��������װ�汾5.x

?

����4.ͬ��������4

?

����5. ʹ�������н����е� .proto�ļ�����һ��game.js�ļ�

pbjs -t commonjs *.proto > game.js

?

����6. ͨ��ts�ű��ļ������ص�������

import * as game from "./game"
 
export var proto: any = null;
 
export default class ProtoManager {
    private static ins: ProtoManager;
 
    public static get I(): ProtoManager {
        if (!ProtoManager.ins) {
            ProtoManager.ins = new ProtoManager();
        }
        return ProtoManager.ins;
    }
 
    public initCommon() {
        if (!proto) {
            proto = game['protos'];
        }
    }
}
v5.x����

let req = new proto["HeartbeatReq"];

req.msec = MKUtils.getCurrentTime();

this.m_socket.send(req.toArrayBuffer(), MsgID);
https://blog.csdn.net/xiefeifei316948714/article/details/90481643